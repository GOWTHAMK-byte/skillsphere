{% extends 'base.html' %}

{% block content %}
<div class="max-w-6xl mx-auto py-12 px-2 md:px-0">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-12 gap-6">
        <div>
            <h1 class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-violet-400 via-fuchsia-400 to-blue-400 mb-2 drop-shadow-lg">Welcome, {{ current_user.profile.name or current_user.username }}!</h1>
            <p class="text-lg text-violet-200/80 mt-2">Hereâ€™s your personalized activity hub. Track your teams and applications at a glance.</p>
        </div>
        <div class="flex items-center gap-4">
            <a href="{{ url_for('create_post') }}" class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-700 to-fuchsia-700 hover:from-violet-800 hover:to-fuchsia-800 text-white font-bold rounded-xl text-base shadow-lg border border-violet-900 transition-all">
                <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"/></svg>
                Create Post
            </a>
        </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-10">
        <!-- Teams (created + joined) -->
        <div class="bg-gradient-to-br from-violet-900/80 to-black/80 rounded-3xl shadow-2xl border-2 border-violet-800 p-10 relative overflow-hidden">
            <div class="absolute -top-10 -right-10 opacity-20 pointer-events-none select-none">
                <svg width="180" height="180" fill="none"><circle cx="90" cy="90" r="80" stroke="#a78bfa" stroke-width="20" /></svg>
            </div>
            <h2 class="text-2xl font-extrabold text-violet-100 mb-6 flex items-center gap-2">
                <svg class="h-7 w-7 text-fuchsia-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a4 4 0 00-3-3.87M9 20H4v-2a4 4 0 013-3.87m9-4V7a4 4 0 00-8 0v3m8 4a4 4 0 01-8 0" /></svg>
                Your Teams
            </h2>
            {% if teams %}
                <ul class="space-y-6">
                    {% for post in teams %}
                        <li class="bg-black/60 rounded-xl p-5 border border-violet-800 shadow flex flex-col gap-2 hover:bg-black/80 transition">
                            <div class="flex items-center gap-3">
                                <a href="{{ url_for('user', username=post.creator.username) }}" class="text-fuchsia-300 hover:underline font-bold text-lg">{{ post.event_name }}</a>
                                <span class="text-xs bg-violet-800/60 text-violet-200 px-3 py-0.5 rounded-full font-semibold ml-2">{{ post.event_type }}</span>
                                <span class="text-xs text-violet-400 ml-2">{{ post.timestamp.strftime('%b %d, %Y') }}</span>
                            </div>
                            <div class="flex flex-wrap gap-2 text-xs mt-1">
                                <span class="bg-violet-900/60 text-violet-200 px-2 py-0.5 rounded font-medium border border-violet-800">Team Size: {{ post.team_size or 'N/A' }}</span>
                                {% if post.gender_requirement and post.gender_requirement != 'Any' %}
                                    <span class="bg-violet-900/60 text-violet-200 px-2 py-0.5 rounded font-medium border border-violet-800">Gender: {{ post.gender_requirement }}</span>
                                {% endif %}
                            </div>
                            <div class="mt-2 text-xs text-violet-300">
                                <span class="font-semibold">Teammates:</span>
                                <ul class="flex flex-wrap gap-1 mt-1">
                                    <li class="bg-gradient-to-r from-violet-700 to-black text-violet-100 px-2 py-0.5 rounded-full text-xs font-medium border border-violet-900">
                                        {{ post.creator.username }} (Creator)
                                    </li>
                                    {% for member in post.teammates %}
                                        {% if member != post.creator %}
                                        <li class="bg-violet-900/60 text-violet-200 px-2 py-0.5 rounded-full text-xs font-medium border border-violet-800">
                                            {{ member.username }}{% if member == current_user %} (You){% endif %}
                                        </li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="flex gap-2 mt-3">
                                {% if post.creator == current_user %}
                                    <a href="{{ url_for('manage_post', post_id=post.id) }}" class="bg-gradient-to-r from-fuchsia-700 to-violet-700 hover:from-fuchsia-800 hover:to-violet-800 text-white font-semibold py-1.5 px-4 rounded-lg border border-fuchsia-900 shadow text-xs">Manage</a>
                                {% else %}
                                    <a href="{{ url_for('user', username=post.creator.username) }}" class="bg-violet-900/60 hover:bg-violet-900 text-violet-200 font-semibold py-1.5 px-4 rounded-lg border border-violet-800 shadow text-xs">View</a>
                                {% endif %}
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="bg-black/70 border border-violet-900 rounded-xl p-8 text-center">
                    <p class="text-violet-400">You are not a member of any teams yet.</p>
                </div>
            {% endif %}
        </div>
        <!-- Applications -->
        <div class="bg-gradient-to-br from-fuchsia-900/80 to-black/80 rounded-3xl shadow-2xl border-2 border-fuchsia-800 p-10 relative overflow-hidden">
            <div class="absolute -top-10 -right-10 opacity-20 pointer-events-none select-none">
                <svg width="180" height="180" fill="none"><circle cx="90" cy="90" r="80" stroke="#f472b6" stroke-width="20" /></svg>
            </div>
            <h2 class="text-2xl font-extrabold text-fuchsia-100 mb-6 flex items-center gap-2">
                <svg class="h-7 w-7 text-violet-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 01.88 7.903A4.992 4.992 0 0112 21a4.992 4.992 0 01-4.88-6.097A4 4 0 118 7" /></svg>
                Your Applications
            </h2>
            {% if applications %}
                <ul class="space-y-6">
                    {% for app in applications %}
                        <li class="bg-black/60 rounded-xl p-5 border border-fuchsia-800 shadow flex flex-col gap-2 hover:bg-black/80 transition">
                            <div class="flex items-center gap-3">
                                <a href="{{ url_for('user', username=app.post.creator.username) }}" class="text-violet-300 hover:underline font-bold text-lg">{{ app.post.event_name }}</a>
                                <span class="text-xs bg-fuchsia-800/60 text-fuchsia-200 px-3 py-0.5 rounded-full font-semibold ml-2">{{ app.post.event_type }}</span>
                                <span class="text-xs text-fuchsia-400 ml-2">{{ app.post.timestamp.strftime('%b %d, %Y') }}</span>
                            </div>
                            <div class="flex flex-wrap gap-2 text-xs mt-1">
                                <span class="bg-fuchsia-900/60 text-fuchsia-200 px-2 py-0.5 rounded font-medium border border-fuchsia-800">Team Size: {{ app.post.team_size or 'N/A' }}</span>
                                {% if app.post.gender_requirement and app.post.gender_requirement != 'Any' %}
                                    <span class="bg-fuchsia-900/60 text-fuchsia-200 px-2 py-0.5 rounded font-medium border border-fuchsia-800">Gender: {{ app.post.gender_requirement }}</span>
                                {% endif %}
                            </div>
                            <div class="mt-2 text-xs text-fuchsia-300">
                                <span class="font-semibold">Teammates:</span>
                                <ul class="flex flex-wrap gap-1 mt-1">
                                    <li class="bg-gradient-to-r from-fuchsia-700 to-black text-fuchsia-100 px-2 py-0.5 rounded-full text-xs font-medium border border-fuchsia-900">
                                        {{ app.post.creator.username }} (Creator)
                                    </li>
                                    {% for member in app.post.teammates %}
                                        {% if member != app.post.creator %}
                                        <li class="bg-fuchsia-900/60 text-fuchsia-200 px-2 py-0.5 rounded-full text-xs font-medium border border-fuchsia-800">
                                            {{ member.username }}{% if member == current_user %} (You){% endif %}
                                        </li>
                                        {% endif %}
                                    {% endfor %}
                                </ul>
                            </div>
                            <div class="flex gap-2 mt-3">
                                <a href="{{ url_for('user', username=app.post.creator.username) }}" class="bg-fuchsia-900/60 hover:bg-fuchsia-900 text-fuchsia-200 font-semibold py-1.5 px-4 rounded-lg border border-fuchsia-800 shadow text-xs">View</a>
                                {% if app.status %}
                                    <span class="bg-gradient-to-r from-green-700 to-green-900 text-white font-semibold py-1.5 px-4 rounded-lg border border-green-900 shadow text-xs">Status: {{ app.status }}</span>
                                {% endif %}
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <div class="bg-black/70 border border-fuchsia-900 rounded-xl p-8 text-center">
                    <p class="text-fuchsia-400">You haven't applied to any posts yet.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
